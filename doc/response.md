### **服务 auth 错误链路根因分析报告**

#### **结论摘要**
服务 `auth` 的所有失败请求均返回 **404 Not Found**，表明客户端请求的接口路径不存在，而非服务内部逻辑错误或依赖故障。该问题源于接口路径配置错误、前端调用错误或服务未正确部署相关接口。

---

#### **关键数据**
以下为 `auth` 服务中高频失败的接口及特征：

| 接口路径 | HTTP 方法 | 错误码 | 耗时 | 调用来源 |
|----------|-----------|--------|------|----------|
| `/authpermission/listUsers` | GET | 404 | 0 ms | 客户端直接调用 |
| `/auth/sys/config/list_menu_module` | POST | 404 | 26 ms | 客户端直接调用 |
| `/auth/sys/menu/list` | POST | 404 | 25 ms | 客户端直接调用 |
| `/auth/authentication/authorization/application` | POST | 404 | 33–37 ms | **st-logplatform-service**（其他服务调用） |
| `/auth/sys/role/list` | POST | 404 | 25–34 ms | 客户端直接调用 |

> ✅ **重要观察**：
> - 所有错误均为 **404**，**无数据库、缓存或第三方服务失败**。
> - Redis（Lettuce）缓存调用均为 **成功**，说明服务能正常访问缓存。
> - 有来自 `st-logplatform-service` 的调用，说明**其他系统依赖此接口但路径错误**。

---

#### **推理逻辑**
- **为什么失败？**  
  所有错误均显示 `http.status_code: 404`，说明请求的 URL 路径在 `auth` 服务中**不存在**。
    - 可能原因：
        1. 前端或调用方误用了旧版或错误的接口路径（如 `/authpermission/listUsers` 应为 `/auth/permission/list`）
        2. `auth` 服务未部署最新版本，接口被移除或重命名
        3. 服务网关（如 Gateway）路由配置错误，未正确转发请求

- **为什么缓存正常？**  
  每次失败前都有 Redis GET 操作成功，说明服务已启动、网络通畅、配置加载正常，**问题不在运行时依赖，而在请求路由**。

- **为什么 `st-logplatform-service` 也调用失败？**  
  说明该问题已影响**跨系统集成**，需立即通知该服务团队修正调用地址。

---

#### **下一步建议**
1. **检查 `auth` 服务的最新接口文档**，确认 `/authpermission/listUsers` 等路径是否已被废弃或重命名。
2. **通知前端/调用方团队**（如 `st-logplatform-service`）：
    - 修正请求 URL 为当前有效路径（如 `/auth/permission/list`）
    - 提供 API 文档链接或版本变更说明
3. **验证部署版本**：确认 `auth` 服务当前版本是否包含这些接口，若无，则需回滚或重新部署。
4. **建议**：若这些接口已废弃，应在服务中添加**统一 404 响应日志**，便于快速识别调用方误用行为。

> 🔍 **是否需要查看某条具体链路的完整调用链？**（如 `be82591448aa43de9951c24e4ddb9fbf.3067.17669790506544215`）  
> 或需要我帮你**对比当前接口列表**，确认哪些路径是有效的？